#!/bin/bash

# ===============================
# ðŸªŸ SESSION MANAGER V4
# ===============================

case "$1" in
    new)
        session_name="${2:-$(basename $(pwd))}"
        if tmux has-session -t "$session_name" 2>/dev/null; then
            echo "Session '$session_name' already exists. Attaching..."
            tmux attach-session -t "$session_name"
        else
            echo "Creating new session: $session_name"
            tmux new-session -d -s "$session_name"
            tmux attach-session -t "$session_name"
        fi
        ;;
    list|ls)
        tmux list-sessions
        ;;
    attach|a)
        if [[ -n "$2" ]]; then
            tmux attach-session -t "$2"
        else
            tmux attach-session
        fi
        ;;
    kill|k)
        if [[ -n "$2" ]]; then
            tmux kill-session -t "$2"
        else
            echo "Usage: session-manager kill <session_name>"
        fi
        ;;
    dev)
        echo "ðŸš€ Starting development session..."
        session_name="dev-$(basename $(pwd))"
        
        if tmux has-session -t "$session_name" 2>/dev/null; then
            tmux attach-session -t "$session_name"
        else
            # Create development layout
            tmux new-session -d -s "$session_name"
            tmux split-window -h -p 50
            tmux split-window -v -p 50  
            tmux select-pane -t 0
            tmux split-window -v -p 50
            tmux select-pane -t 0
            
            # Setup panes
            tmux send-keys -t "$session_name:0.0" 'nvim .' C-m
            tmux send-keys -t "$session_name:0.2" 'git status' C-m
            
            tmux attach-session -t "$session_name"
        fi
        ;;
    *)
        echo "Usage: session-manager {new [name]|list|attach [name]|kill <name>|dev}"
        echo "  new [name]    - Create new session (default: current dir name)"
        echo "  list          - List all sessions"
        echo "  attach [name] - Attach to session"
        echo "  kill <name>   - Kill session"
        echo "  dev           - Create development layout"
        ;;
esac
