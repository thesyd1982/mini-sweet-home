# ===============================
# ðŸ  MINI SWEET HOME - ZSH CONFIG
# ===============================

# Path setup
export PATH="$HOME/.local/bin:$PATH"

# ZSH settings (load early)
autoload -Uz compinit && compinit
setopt AUTO_CD HIST_IGNORE_DUPS HIST_IGNORE_SPACE SHARE_HISTORY
HISTFILE=~/.zsh_history
HISTSIZE=10000
SAVEHIST=10000

# Load Mini Sweet Home configs BEFORE modern tools
MSH_CONFIG_DIR="$HOME/mini-sweet-home/config/shell/zsh"

if [[ -d "$MSH_CONFIG_DIR" ]]; then
    [[ -f "$MSH_CONFIG_DIR/exports.zsh" ]] && source "$MSH_CONFIG_DIR/exports.zsh"
    [[ -f "$MSH_CONFIG_DIR/functions.zsh" ]] && source "$MSH_CONFIG_DIR/functions.zsh"
    # Load aliases but UNSET conflicting cd alias before zoxide
    [[ -f "$MSH_CONFIG_DIR/aliases.zsh" ]] && source "$MSH_CONFIG_DIR/aliases.zsh"
    
    # Remove problematic cd alias if it exists
    unalias cd 2>/dev/null || true
    
    [[ -f "$MSH_CONFIG_DIR/prompt.zsh" ]] && source "$MSH_CONFIG_DIR/prompt.zsh"
fi

# Initialize modern tools AFTER loading configs
# zoxide init moved to exports.zsh

# MSH v3.0 - Load intelligent fallbacks
MSH_FALLBACKS_SCRIPT="$HOME/mini-sweet-home/lib/fallbacks.sh"
if [[ -f "$MSH_FALLBACKS_SCRIPT" ]]; then
    source "$MSH_FALLBACKS_SCRIPT" quiet 2>/dev/null || true
fi

# Note: Starship removed - using minimal lambda prompt from prompt.zsh

export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"  # This loads nvm
[ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"  # This loads nvm bash_completion
export PATH="$PATH:$(go env GOPATH)/bin"

# pnpm
export PNPM_HOME="/home/thesyd/.local/share/pnpm"
case ":$PATH:" in
  *":$PNPM_HOME:"*) ;;
  *) export PATH="$PNPM_HOME:$PATH" ;;
esac
# pnpm end

# ===============================
# ðŸŽ¨ ZSH PLUGINS (FORCE LOAD)
# ===============================
# Force loading of ZSH plugins to ensure they work
[[ -f ~/.zsh-syntax-highlighting/zsh-syntax-highlighting.zsh ]] && 
    source ~/.zsh-syntax-highlighting/zsh-syntax-highlighting.zsh

if [[ -f ~/.zsh-autosuggestions/zsh-autosuggestions.zsh ]]; then
    source ~/.zsh-autosuggestions/zsh-autosuggestions.zsh
    ZSH_AUTOSUGGEST_HIGHLIGHT_STYLE='fg=240'
    bindkey '^[[Z' autosuggest-accept  # Shift-Tab to accept
fi
